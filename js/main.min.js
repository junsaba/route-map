var data,canvas,ctx,map_x=0,map_y=0,mouse_x,mouse_y,mouse_drag;function init(){canvas.width=document.body.clientWidth,canvas.height=document.body.clientHeight,ctx.translate(document.body.clientWidth/2,document.body.clientHeight/2),ctx.lineWidth=5,ctx.font="0.75rem sans-serif",ctx.textAlign="center"}function draw(){ctx.clearRect(canvas.width/2*-1,canvas.height/2*-1,canvas.width,canvas.height);var stations=[];for(d1 in data)for(d2 in CompanyData=data[d1],ctx.fillStyle=CompanyData.color,ctx.strokeStyle=CompanyData.color,linesData=CompanyData.point,linesData){for(d3 in routeData=linesData[d2],ctx.beginPath(),ctx.moveTo(map_x+routeData[0].coord[0],map_y+routeData[0].coord[1]),routeData)pointData=routeData[d3],coord=pointData.coord,"station"in pointData&&(ctx.fillRect(map_x+coord[0]-10,map_y+coord[1]-10,20,20),stations.push([pointData.station,map_x+coord[0],map_y+coord[1]-15])),Number(d3)<routeData.length-1&&(nextCoord=routeData[Number(d3)+1].coord,ctx.lineTo(map_x+nextCoord[0],map_y+nextCoord[1]));ctx.stroke()}for(s1 in ctx.fillStyle="#000",stations)ctx.fillText(stations[s1][0],stations[s1][1],stations[s1][2])}onload=()=>{var xhr=new XMLHttpRequest;xhr.responseType="json",xhr.onload=()=>{data=xhr.response,init(),draw()},xhr.open("GET","data.json"),xhr.send(),canvas=document.getElementById("main"),ctx=canvas.getContext("2d"),canvas.onmousedown=e=>{mouse_x=e.offsetX,mouse_y=e.offsetY,mouse_drag=!0},document.onmouseup=()=>mouse_drag=!1,canvas.onmousemove=e=>{mouse_drag&&(map_x+=e.offsetX-mouse_x,map_y+=e.offsetY-mouse_y,draw(),mouse_x=e.offsetX,mouse_y=e.offsetY),document.getElementsByClassName("coord")[0].innerText=`${-1*map_x+e.offsetX-document.body.clientWidth/2}, ${-1*map_y+e.offsetY-document.body.clientHeight/2}`}},onresize=()=>{init(),draw()};